# ENT-002 â€” RBAC/ABAC policy engine enforced across APIs and UI

- Type: **story**
- Milestone: `M6-ENTERPRISE`
- Repo alignment: **partial**
- Labels: `backend`, `security`, `rbac`
- Depends on: `ENT-001`, `P0-003`

## Problem

Tenant isolation is necessary but not sufficient. Need role-based access at workspace/project/app level (viewer/editor/admin) plus fine-grained permissions for documents and tools.

## Proposed solution

Implement authorization:
- Define roles and permissions (RBAC) plus scope checks (ABAC) using tenant_id, project_id, app_id.
- Add middleware/dependency to enforce policies in each router.
- Add UI guards: hide/disable actions based on role.

## Repo touchpoints

- `src/intelli/api/deps.py`
- `src/intelli/db/models/auth.py`
- `src/intelli/security/* (new)`

## Acceptance criteria

- Core resources (projects, docs, runs, apps, tools) enforce permissions.
- Audit logs capture permission denials and privileged actions.

## Test plan

- Integration: verify access matrix for key endpoints.
