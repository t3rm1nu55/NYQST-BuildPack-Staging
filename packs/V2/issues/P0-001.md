# P0-001 â€” Fix arq WorkerSettings.functions dynamic registration bug

- Type: **task**
- Milestone: `M0-P0`
- Repo alignment: **missing**
- Labels: `priority:P0`, `backend`, `arq`
- Depends on: `EPIC-P0`

## Problem

`WorkerSettings.functions` is computed at class definition time from `function_registry`; later calls to `register_job()` will not be picked up by running workers.

## Proposed solution

Update `src/intelli/core/jobs.py` so `WorkerSettings.functions` is a dynamic property or is recomputed during worker startup.

Preferred approach:
- Make `WorkerSettings` expose `functions()` as a `@staticmethod` returning `list(function_registry.values())`, or
- Implement `on_startup` hook to refresh.

Ensure hot-reload and multi-worker deployments behave deterministically.

## Repo touchpoints

- `src/intelli/core/jobs.py`
- `src/intelli/core/jobs_registry.py`
- `tests/unit/test_jobs.py`

## Spec / reference pointers

- reference/NYQST_Platform_Production_Intelligence_Build_Guide_v5.md (P0-1)

## Acceptance criteria

- Registering a job via `register_job()` after module import results in the worker executing it.
- Worker startup logs show the final function list and count.
- No regression to existing job execution.

## Test plan

- Unit test: register dummy job after import; assert WorkerSettings exposes it.
- Integration test: enqueue job; assert worker executes (can use arq test utilities).

## Notes

This is explicitly called out as a P0 fix in the build guide.
