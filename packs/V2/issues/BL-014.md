# BL-014 — Context management & inheritance (task → app → project → workspace) with background indexing

- Type: **story**
- Milestone: `M3-W2`
- Repo alignment: **missing**
- Labels: `backend`, `frontend`, `context`, `wave:2`
- Depends on: `BL-013`, `EPIC-PLUGINS`

## Problem

Spec requires context packs and inheritance similar to Cursor: background indexing of documents, conversations, and project knowledge, plus the ability for tasks to inherit context from higher scopes.

## Proposed solution

Implement context packs and inheritance:
- Data model: `ContextPack` with scope (workspace/project/app/task), content sources (docs, notes, links), and derived embeddings.
- Ingestion: background jobs build/update embeddings and indexes on changes.
- Retrieval: tools accept `context_pack_ids` and merge results with precedence rules (task overrides project overrides workspace).
- UI: context manager page with pack creation, attachment to projects/apps, and visibility into indexed sources.

## Repo touchpoints

- `src/intelli/db/models/* (new context packs)`
- `src/intelli/services/indexing/*`
- `ui/src/pages/SettingsPage.tsx (new)`
- `ui/src/components/context/* (new)`

## Spec / reference pointers

- reference/archive/plans/BACKLOG.md (BL-014)

## Acceptance criteria

- Context packs can be created at project/workspace scope and attached to runs.
- Runs inherit context automatically based on conversation scope.
- Background indexing keeps embeddings up-to-date without manual triggers.

## Test plan

- Integration: create workspace pack + project pack; run inherits both with correct precedence.
- Load test: indexing queue handles N docs without falling behind (define N).
