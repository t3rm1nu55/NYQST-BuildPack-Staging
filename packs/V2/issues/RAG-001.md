# RAG-001 â€” Hybrid retrieval (vector + keyword) + reranking + metadata filters

- Type: **story**
- Milestone: `M3-W2`
- Repo alignment: **missing**
- Labels: `backend`, `rag`, `quality`
- Depends on: `BL-013`, `EPIC-OBS`

## Problem

Basic vector search often returns irrelevant chunks. Dify/NotebookLM-style quality requires hybrid retrieval, metadata filters, and reranking.

## Proposed solution

Improve retrieval:
- Implement hybrid query in OpenSearch combining BM25 + vector kNN.
- Add metadata filters (doc_id, notebook_id, corpus_id, tags, date ranges).
- Add optional reranker stage (cross-encoder or LLM rerank) with budget limits.

## Acceptance criteria

- Retrieval quality improves on a benchmark set (define: top-k precision).
- Filters allow restricting results to notebook/corpus/project contexts reliably.

## Test plan

- Eval: retrieval benchmark harness; integration tests for filters.

## Notes

Inspired by Dify/SurfSense patterns (hybrid + rerank + filters).
