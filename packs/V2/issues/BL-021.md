# BL-021 â€” Clarification flow (interactive): structured questions when intent/constraints missing

- Type: **story**
- Milestone: `M4-W3`
- Repo alignment: **missing**
- Labels: `backend`, `frontend`, `wave:3`
- Depends on: `BL-017`, `BL-002`

## Problem

For ambiguous prompts, the system should ask clarifying questions instead of generating low-confidence output. Repo does not yet support a structured clarification loop.

## Proposed solution

Add clarification flow:
- Backend: detect ambiguity/insufficient constraints (via planner confidence + meta reasoning).
- Emit `clarification_requested` event with structured questions + multiple-choice options when possible.
- UI: show an interstitial question card; user responses feed back into graph as additional context; run resumes.

## Spec / reference pointers

- reference/archive/plans/BACKLOG.md (BL-021)

## Acceptance criteria

- Ambiguous prompts trigger clarification instead of immediate generation.
- User answers are persisted and appended to the run context.
- Run can resume and produce deliverable after clarification.

## Test plan

- E2E: ambiguous prompt triggers clarification; answering resumes run and completes.
