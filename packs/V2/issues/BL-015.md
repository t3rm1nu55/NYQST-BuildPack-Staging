# BL-015 — DeliverableStore + per-message deliverable selection (report / website / slides / document)

- Type: **story**
- Milestone: `M3-W2`
- Repo alignment: **missing**
- Labels: `backend`, `frontend`, `deliverables`, `wave:2`
- Depends on: `BL-002`, `BL-006`

## Problem

Deliverables are core UX: user must be able to select output type per prompt. Repo currently has deliverable_type at conversation level and lacks a deliverable store/service.

## Proposed solution

Implement deliverable selection and storage:
- DB: add `messages.deliverable_type` (string enum) and migrate/backfill from `conversation.deliverable_type`.
- API: agent chat endpoint accepts deliverable_type per message.
- DeliverableStore: maps `reportIdentifier` → list of artifacts + metadata; supports versions, refresh, and retrieval by identifier.
- UI: add a DeliverableSelector control in Chat input (defaults to report/chat).

## Repo touchpoints

- `src/intelli/db/models/conversations.py`
- `src/intelli/api/v1/agent.py`
- `ui/src/providers/assistant-runtime.tsx`

## Spec / reference pointers

- reference/archive/plans/BACKLOG.md (BL-015)

## Acceptance criteria

- User can choose deliverable type per prompt without creating a new conversation.
- Generated deliverables are stored and can be reopened by identifier later.
- Backwards compatible: existing conversations continue working with a default deliverable type.

## Test plan

- Migration test: deliverable_type backfill and default behaviour.
- E2E: switch deliverable types between turns and see correct pipeline invoked.
